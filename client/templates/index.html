<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hệ Thống Đặt Vé Xe Khách</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=4">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
                    <rect width="40" height="40" rx="8" fill="#3B82F6" />
                    <path d="M10 15h20v10H10z" fill="white" />
                    <circle cx="15" cy="30" r="2" fill="white" />
                    <circle cx="25" cy="30" r="2" fill="white" />
                </svg>
                <h1>Xe Khách Trực Tuyến</h1>
            </div>
            <div class="connection-status" id="connectionStatus">
                <span class="status-dot"></span>
                <span>Kết nối</span>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Bước 1: Chọn tuyến -->
            <section class="step" id="step1">
                <div class="step-header">
                    <span class="step-number">1</span>
                    <h2>Chọn Điểm Đi - Điểm Đến</h2>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Đi từ đâu</label>
                        <select id="fromCity" class="select-input">
                            <option value="">Chọn thành phố...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Đi đến đâu</label>
                        <select id="toCity" class="select-input">
                            <option value="">Chọn thành phố...</option>
                        </select>
                    </div>
                </div>
                <div id="routesList" class="routes-list"></div>
            </section>

            <!-- Bước 2: Chọn ngày -->
            <section class="step" id="step2" style="display: none;">
                <div class="step-header">
                    <button class="btn-back" onclick="goBack(1)">← Quay lại</button>
                    <span class="step-number">2</span>
                    <h2>Chọn Ngày Khởi Hành</h2>
                </div>
                <div id="datesList" class="dates-list"></div>
            </section>

            <!-- Bước 3: Chọn chuyến xe -->
            <section class="step" id="step3" style="display: none;">
                <div class="step-header">
                    <button class="btn-back" onclick="goBack(2)">← Quay lại</button>
                    <span class="step-number">3</span>
                    <h2>Chọn Chuyến Xe</h2>
                </div>
                <div id="tripsList" class="trips-list"></div>
            </section>

            <!-- Bước 4: Chọn ghế -->
            <section class="step" id="step4" style="display: none;">
                <div class="step-header">
                    <button class="btn-back" onclick="goBack(3)">← Quay lại</button>
                    <span class="step-number">4</span>
                    <h2>Chọn Ghế</h2>
                </div>

                <div class="seat-legend">
                    <div class="legend-item">
                        <div class="seat-demo available"></div>
                        <span>Còn trống</span>
                    </div>
                    <div class="legend-item">
                        <div class="seat-demo selecting"></div>
                        <span>Đang chọn</span>
                    </div>
                    <div class="legend-item">
                        <div class="seat-demo booked"></div>
                        <span>Đã đặt</span>
                    </div>
                </div>

                <div class="bus-layout">
                    <!-- Tầng 1 -->
                    <div class="floor">
                        <h3>Tầng 1</h3>
                        <div class="seats-grid" id="floor1"></div>
                    </div>

                    <!-- Tầng 2 -->
                    <div class="floor">
                        <h3>Tầng 2</h3>
                        <div class="seats-grid" id="floor2"></div>
                    </div>
                </div>

                <div class="selected-seats-info">
                    <p>Ghế đã chọn: <strong id="selectedSeatsDisplay">Chưa chọn</strong></p>
                </div>

                <button class="btn-primary" id="continueToBooking" style="display: none;">
                    Tiếp tục đặt vé
                </button>
            </section>

            <!-- Bước 5: Thông tin khách hàng -->
            <section class="step" id="step5" style="display: none;">
                <div class="step-header">
                    <button class="btn-back" onclick="goBack(4)">← Quay lại</button>
                    <span class="step-number">5</span>
                    <h2>Thông Tin Khách Hàng</h2>
                </div>

                <div class="booking-summary" id="bookingSummary"></div>

                <form id="customerForm" class="customer-form">
                    <div class="form-group">
                        <label>Họ và tên *</label>
                        <input type="text" id="customerName" required class="text-input">
                    </div>
                    <div class="form-group">
                        <label>Số điện thoại *</label>
                        <input type="tel" id="customerPhone" required class="text-input">
                    </div>
                    <div class="form-group">
                        <label>Số CCCD *</label>
                        <input type="text" id="customerCCCD" required class="text-input">
                    </div>

                    <div class="form-group">
                        <label>Upload ảnh CCCD / Giấy tờ (tùy chọn)</label>
                        <input type="file" id="uploadFiles" multiple accept="image/*,.pdf" class="text-input"
                            style="padding: 10px;">
                        <small style="color: #6b7280; font-size: 12px;">Hỗ trợ: JPG, PNG, PDF. Có thể chọn nhiều
                            file.</small>
                    </div>

                    <button type="submit" class="btn-primary btn-large">
                        Xác nhận đặt vé
                    </button>
                </form>
            </section>

            <!-- Kết quả -->
            <section class="step" id="stepSuccess" style="display: none;">
                <div class="success-message">
                    <div class="success-icon">&#10004;</div>
                    <h2>Đặt Vé Thành Công!</h2>
                    <div id="bookingResult"></div>
                    <button class="btn-primary" onclick="location.reload()">
                        Đặt vé mới
                    </button>
                </div>
            </section>
        </main>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}?v=4"></script>
</body>

</html>